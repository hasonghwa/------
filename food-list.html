<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ìŒì‹ ëª©ë¡ ê´€ë¦¬</title>
  <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
    crossorigin="anonymous"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    /* ğŸŠ ì „ì²´ ë°°ê²½ê³¼ í°íŠ¸ */
    body {
      background: linear-gradient(135deg, #ffb347, #ffe259);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 40px 20px;
      display: flex;
      justify-content: center;
      min-height: 100vh;
      color: #333;
    }

    #app {
      background: white;
      padding: 30px 40px;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
      width: 900px;
      max-width: 100%;
      border: 3px solid #fff3cd;
    }

    /* ì…€ë ‰íŠ¸ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ê°œì„  */
    select {
      padding: 8px 12px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ffa726;
      margin-bottom: 25px;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    select:focus {
      outline: none;
      border-color: #f57c00;
      box-shadow: 0 0 6px rgba(245, 124, 0, 0.4);
    }

    /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
    table {
      width: 100%;
      border-collapse: collapse;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      overflow: hidden;
    }

    th,
    td {
      padding: 14px 20px;
      border-bottom: 1px solid #f0e6cc;
      text-align: center;
      font-size: 15px;
    }

    th {
      background-color: #ffa726;
      color: white;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    tr:hover {
      background-color: #fff8e1;
    }

    /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
    button {
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.1s ease;
      user-select: none;
      margin: 0 5px;
      background-color: #ff7043;
      color: white;
    }

    button:hover {
      background-color: #f4511e;
      box-shadow: 0 6px 14px rgba(244, 81, 30, 0.5);
      transform: translateY(-1px);
    }

    button:active {
      transform: translateY(0);
    }

    /* ìˆ˜ì •í¼ ìŠ¤íƒ€ì¼ */
    [v-cloak] {
      display: none;
    }

    input[type="text"],
    input[type="hidden"] {
      padding: 8px 12px;
      font-size: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      width: 100%;
      max-width: 300px;
      margin-bottom: 15px;
      box-sizing: border-box;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #ffb300;
      box-shadow: 0 0 6px rgba(255, 179, 0, 0.4);
    }

    /* ìˆ˜ì •í¼ ë ˆì´ì•„ì›ƒ */
    .edit-container>div {
      margin-bottom: 12px;
      font-size: 16px;
    }

    .edit-container label {
      font-weight: 600;
      margin-right: 10px;
      color: #555;
    }

    .edit-buttons {
      margin-top: 20px;
    }

    .edit-buttons button {
      margin-right: 12px;
      width: 90px;
    }

    /* ì¶”ê°€ ë²„íŠ¼ */
    .add-btn {
      margin-top: 20px;
      background-color: #ffa726;
      color: white;
      padding: 12px 28px;
      font-size: 16px;
      border-radius: 10px;
      box-shadow: 0 6px 14px rgba(255, 167, 38, 0.5);
      user-select: none;
      transition: background-color 0.3s ease;
    }

    .add-btn:hover {
      background-color: #f57c00;
      box-shadow: 0 8px 20px rgba(245, 124, 0, 0.6);
    }
  </style>
</head>

<body>
  <div id="app" v-cloak>
    
    <div v-if="!editMode">
      <select v-model="foodCategory" @change="fnFoodList">
        <option :value="''">ì „ì²´</option>
        <option :value="10">í•œì‹</option>
        <option :value="20">ì–‘ì‹</option>
        <option :value="30">ì¤‘ì‹</option>
        <option :value="40">ì¼ì‹</option>
        <option :value="50">ë””ì €íŠ¸</option>
        <option :value="60">ìŒë£Œ</option>
      </select>
    </div>
  


    <div v-if="!editMode">
      <table>
        <thead>
          <tr>
            <th>ë²ˆí˜¸</th>
            <th>ìŒì‹ ì´ë¦„</th>
            <th>ì¢…ë¥˜</th>
            <th>#</th>
            <th>ì¶”ì²œ</th>
            <th colspan="2">ê´€ë¦¬</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="item in list" :key="item.FOOD_TYPE_ID">
            <td>{{ item.FOOD_TYPE_ID }}</td>
            <td>{{ item.FOOD_TYPE_NAME }}</td>
            <!-- ì¢…ë¥˜ í…ìŠ¤íŠ¸ í‘œì‹œ -->
            <td>{{ mapCategory(item.DESCRIPTION) }}</td>
            <td>{{ item.RECOMMEND_MOOD }}</td>
            <td>{{ mapCategory(item.RECOMMEND_DESCRIPTION) }}</td>
            <td><button @click="fnRemove(item.FOOD_TYPE_ID)">ì‚­ì œ</button></td>
            <td><button @click="fnEditMode(item)">ìˆ˜ì •</button></td>
          </tr>
          <tr v-if="list.length === 0">
            <td colspan="7" style="padding: 20px; font-style: italic; color: #666;">
              ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.
            </td>
          </tr>
        </tbody>
      </table>
      <div>
        <button class="add-btn" @click="fnAdd">ìŒì‹ ì¢…ë¥˜ ì¶”ê°€</button>
      </div>
    </div>

    <div v-else class="edit-container">
      <input type="hidden" v-model="foodNo" />
      <div>ë²ˆí˜¸: <strong>{{ info.FOOD_TYPE_ID }}</strong></div>
      <div>
        <label for="name">ì´ë¦„:</label>
        <input id="name" type="text" v-model="name" />
      </div>


      <div>
        <label for="descr">ì¢…ë¥˜:</label>
        <select id="descr" v-model="descr" style="max-height: 120px; overflow-y: auto;">
          <option value="">-- ì„ íƒí•˜ì„¸ìš” --</option>
          <option value="10">í•œì‹</option>
          <option value="20">ì–‘ì‹</option>
          <option value="30">ì¤‘ì‹</option>
          <option value="40">ì¼ì‹</option>
          <option value="50">ë””ì €íŠ¸</option>
          <option value="60">ìŒë£Œ</option>
        </select>
      </div>
      <div>
        <label for="mood">#:</label>
        <input id="mood" type="text" v-model="mood" />
      </div>
      <div>
        <label for="reco">ì¶”ì²œ ì„¤ëª…:</label>
        <input id="reco" type="text" v-model="reco" />
      </div>
      <div class="edit-buttons">
        <button @click="fnEdit">ìˆ˜ì •</button>
        <button @click="editMode = false" style="background-color:#999; color:#fff;">ì·¨ì†Œ</button>
      </div>
    </div>
  </div>

  <script>
    const app = Vue.createApp({
      data() {
        return {
          list: [],
          info: {},
          editMode: false,
          name: '',
          descr: '',
          mood: '',
          reco: '',
          foodNo: "",
          foodCategory: "",
          FoodList: []
        };
      },
      methods: {
        mapCategory(value) {
          const map = {
            10: "í•œì‹",
            20: "ì–‘ì‹",
            30: "ì¤‘ì‹",
            40: "ì¼ì‹",
            50: "ë””ì €íŠ¸",
            60: "ìŒë£Œ"
          };
          return map[value] || value;
        },

        fnFoodList() {
          let self = this;
          $.ajax({
            url: "http://localhost:3009/food/list",
            dataType: "json",
            type: "GET",
            data: {
              foodNo: self.foodNo,
              foodCategory: self.foodCategory
            },
            success(data) {
              console.log(data);
              self.list = data.list;
            },
            error(err) {
              console.error("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨", err);
            }
          });
        },
        fnRemove(foodNumber) {
          let self = this;
          if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            return;
          }
          $.ajax({
            url: "http://localhost:3009/food/delete",
            dataType: "json",
            type: "GET",
            data: {
              foodId: foodNumber
            },
            success(data) {
              alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤!");
              self.fnFoodList();
            },
            error(err) {
              alert("ì‚­ì œ ì‹¤íŒ¨");
              console.error(err);
            }
          });
        },
        fnEdit() {
          let self = this;
          if (!confirm("ì •ë§ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            return;
          }
          let param = {
            name: self.name,
            descr: self.descr,
            foodNo: self.info.FOOD_TYPE_ID,
            mood: self.mood,
            reco: self.reco
          };
          $.ajax({
            url: "http://localhost:3009/food/update",
            dataType: "json",
            type: "GET",
            data: param,
            success(data) {
              alert("ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!");
              self.fnFoodList();
              self.editMode = false;
            },
            error(err) {
              alert("ìˆ˜ì • ì‹¤íŒ¨");
              console.error(err);
            }
          });
        },
        fnEditMode(map) {
          let self = this;
          self.info = map;
          self.name = map.FOOD_TYPE_NAME;
          self.descr = map.DESCRIPTION;
          self.mood = map.RECOMMEND_MOOD;
          self.reco = map.RECOMMEND_DESCRIPTION;
          self.editMode = true;
        },
        fnAdd() {
          location.href = "food-insert.html";
        }
      },
      mounted() {
        const params = new URLSearchParams(window.location.search);
        const category = params.get("category");
        if (category) {
          this.foodCategory = Number(category);
        }
        this.fnFoodList();
      }
    });

    app.mount('#app');
  </script>

</html>