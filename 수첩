




<목록에 따라 뜨게 만드는거 (한식은 한식한 뜨고 양식은 양식만 뜨게 만드는거)>

오라클에서 편집->열추가 TYPE 추가한 후 
한식 10, 중식20... 이렇게 나누기
v-model = foodCategory 만든 후 알아서 하기



<food-random.html>
랜덤 1-80번 까지 뽑는 코드를 만들어서 server에서는 food_type_id를 보내고 
food-random.html 에서 출력이 되게 만들기

<보완점>
1.포스트에서 음식종류 추가한 다음 option->예)양식 을 눌렀을 때 내가 추가한 종류 보이게(미완) 타입이 null로 뜨니까 인식을 못하지..
2.랜덤뽑기에서 처음에는 리스트가 안보였다가 누르면 보이게하기(완)
3.회원가입 만들기(완)
4.랜덤뽑기에서 내가 추가한 음식 보이게 하기(완)
5.음식종류 추가할때 원래 번호로 보이게 하기(완)
6.랜덤뽑기에서 option에 따라 음식이 나오게(미완)






2. flg 함수를 써서 코드를 수정함
food-random에서 수정

3.새 테이블을 만듦

4. server /food/random에서 코드를 고침 

(구)
const randomId = Math.floor(Math.random() * 80) + 1;

// 그 ID에 해당하는 음식 1개만 조회
SELECT * FROM FOOD_TYPES WHERE FOOD_TYPE_ID = :id

(현재)
SELECT * FROM (
    SELECT * FROM FOOD_TYPES ORDER BY   DBMS_RANDOM.VALUE(=랜덤숫자 생성 함수 
    {범위 상관없이 모든 음식에서 랜덤선택})
  ) WHERE ROWNUM = 1(=맨 위에 있는 행 딱 하나만 가져옴 ==>랜덤한 음식 1개 선택)
    WHERE ROWNUM <=3(이렇게 하면 랜덤 3개 가져옴)

5.
(추가)  {server(Node.js= 백엔드)수정}
  /food/insert 에서 수정

 // 재사용 가능한 가장 작은 번호 찾기
    const idResult = await connection.execute(`
      SELECT MIN(missing_id) AS NEW_ID (==>최종적으로 가장 작은 번호를 선택해서 재사용하도록 함)
      FROM (
        SELECT LEVEL AS missing_id
        FROM dual(=dual 오직 1개의 행 1개의 열만 가짐 =>테스트 & 단순 값을 가져올 때 주로 쓰임)
        CONNECT BY LEVEL <= (SELECT NVL(MAX(FOOD_TYPE_ID), 0) + 1 FROM FOOD_TYPES) 
        (==>예)테이블 번호가 1,2,4,5라고 가정했을때 MAX(FOOD_TYPE_ID)=5 여기에 +1이 붙어있기 때문에 최종적으로 6까지의 번호가 생성됨 )
        MINUS(==>차집합 이미 존재하는 id를 뺌)
        SELECT FOOD_TYPE_ID FROM FOOD_TYPES
      )
    `);

    const newId = idResult.rows[0][0];  // ex: 3



    // 프론트로 새 ID 전송
    res.json({ success: true, id: newId });
  
  (추가) {프론트(클라이언트 = Vue)수정}
  //food-insert 에서 수정
  success: function (data) {
      if (data.success) {
        alert(`추가되었습니다! 음식 번호는 ${data.id}번입니다.`);
        self.fnBack(); // 돌아가기
      } else {
        alert("추가 실패: " + data.message);
      }
    },
    error: function () {
      alert("서버와의 통신에 실패했습니다.");
    }
  });
}